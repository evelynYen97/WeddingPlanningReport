$(document).ready(function(){let n=JSON.parse(localStorage.getItem("calendarEvents"))||[];$("#calendar").fullCalendar({events:n,dayClick:function(n){$("#dateInput").val(n.format("YYYY-MM-DD"));$("#eventInput").val("");$("#eventItemInput").val("請選擇").trigger("change");$("#contentInput").val("");$("#eventFormModalTitle").text("新增事件");$("#eventFormDelButton").hide();$("#eventFormModal").modal("show")},eventClick:function(t){$("#dateInput").val(t.start.format("YYYY-MM-DD"));$("#eventInput").val(t.title);$("#eventItemInput").val(t.eventItem).trigger("change");$("#contentInput").val(t.description);$("#eventFormModalTitle").text("編輯事件");$("#eventFormDelButton").show();$("#eventFormModal").modal("show");$("#eventFormDelButton").off("click").on("click",function(){if(console.log("Deleting Event ID:",t._id),confirm("確定要刪除這個事件嗎？")){const i=n.findIndex(n=>n._id===Number(t._id));i!==-1?(n.splice(i,1),localStorage.setItem("calendarEvents",JSON.stringify(n)),$("#calendar").fullCalendar("removeEvents",t._id),$("#eventFormModal").modal("hide")):alert("未找到事件，無法刪除。")}})}});$("#eventFormOkButton").click(function(){var i=$("#eventInput").val(),r=$("#dateInput").val(),u=$("#eventItemInput").val(),f=$("#contentInput").val(),t;i?(t={_id:(new Date).getTime(),title:i,start:r,description:f,eventItem:u},n.push(t),localStorage.setItem("calendarEvents",JSON.stringify(n)),$("#calendar").fullCalendar("renderEvent",t,!0),$("#eventFormModal").modal("hide")):alert("請輸入事件名稱")});$("#cancelButton, .close").click(function(){$("#eventFormModal").modal("hide")})});